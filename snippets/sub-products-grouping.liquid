{% if product.metafields.custom.sub_products_grouping %}
    {% assign productUrl = product.url %}
    {% assign recommended_products =  product.metafields.custom.sub_products_grouping.value %}
    {% assign recommended_size = recommended_products | size %}
    <div class="reference__sub_products--wrapper">
        <div class="reference--sub__products--title">{% if product.metafields.custom.title_sub_products_grouping %}{{product.metafields.custom.title_sub_products_grouping}}{% else %}Other versions{% endif %}:</div>
        <div class="swatch is-flex is-flex-wrap">
        {% for val in recommended_products %}
            {% assign splittedValue = val | split: ',' %}
            {% assign displayName = splittedValue | first %}
            {% assign url = splittedValue | last %}
            {% assign isActive = false %}
            {% if  url contains  productUrl %}
                {% assign isActive = true %}
            {% endif %}
            <div class="reference--sub__products--item swatch-element {% if isActive %}active{% endif %}">
                <span><a href="{{url }}">{{displayName}}</a></span>
            </div>
        {% endfor %}
        </div>
    </div>

{% endif %}